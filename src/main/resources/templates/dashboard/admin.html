<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="#{dashboard.admin.title}">Admin Dashboard - LMS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <link th:href="@{/css/lms.css}" rel="stylesheet">
</head>
<body>
    <div th:with="active='dashboard'" th:replace="~{fragments/navbar :: navbar}"></div>

    <div class="container my-5">
        <!-- Page Header -->
        <div class="lms-page-header">
            <h1 th:text="#{dashboard.admin.heading}">Admin Dashboard</h1>
            <p th:text="#{dashboard.admin.subtitle}">Oversee users and manage course configurations</p>
        </div>

        <!-- Stats Row -->
        <div class="row g-4 mb-5">
            <div class="col-md-3">
                <div class="lms-stat">
                    <i class="bi bi-people"></i>
                    <div class="lms-stat-value" th:text="${totalUsers}">0</div>
                    <div class="lms-stat-label" th:text="#{dashboard.admin.totalUsers}">Total Users</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="lms-stat">
                    <i class="bi bi-book"></i>
                    <div class="lms-stat-value" th:text="${totalCourses}">0</div>
                    <div class="lms-stat-label" th:text="#{dashboard.admin.totalCourses}">Total Courses</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="lms-stat">
                    <i class="bi bi-person-badge"></i>
                    <div class="lms-stat-value">-</div>
                    <div class="lms-stat-label" th:text="#{dashboard.admin.instructors}">Instructors</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="lms-stat">
                    <i class="bi bi-mortarboard"></i>
                    <div class="lms-stat-value">-</div>
                    <div class="lms-stat-label" th:text="#{dashboard.admin.students}">Students</div>
                </div>
            </div>
        </div>

        <!-- User Management Section -->
        <h2 class="lms-section-title" th:text="#{dashboard.admin.userManagement}">User Management</h2>
        <div class="lms-table-wrap mb-5">
            <table class="table">
                <thead>
                    <tr>
                        <th th:text="#{dashboard.admin.user.id}">ID</th>
                        <th th:text="#{dashboard.admin.user.username}">Username</th>
                        <th th:text="#{dashboard.admin.user.email}">Email</th>
                        <th th:text="#{dashboard.admin.user.roles}">Roles</th>
                        <th th:text="#{dashboard.admin.user.status}">Status</th>
                        <th th:text="#{dashboard.admin.user.actions}">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="user : ${users}">
                        <td th:text="${user.id}">1</td>
                        <td th:text="${user.username}">username</td>
                        <td th:text="${user.email}">email@example.com</td>
                        <td>
                            <span th:each="role : ${user.roles}" class="lms-badge-purple me-1" th:text="${role.name}">ROLE_STUDENT</span>
                        </td>
                        <td>
                            <span th:if="${user.enabled}" class="lms-badge-green" th:text="#{dashboard.admin.user.active}">Active</span>
                            <span th:unless="${user.enabled}" class="lms-badge-gray" th:text="#{dashboard.admin.user.disabled}">Disabled</span>
                        </td>
                        <td>
                            <a th:href="@{/admin/users/{id}/edit(id=${user.id})}" class="text-decoration-none">
                                <i class="bi bi-pencil"></i>
                            </a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Course Overview Section -->
        <h2 class="lms-section-title" th:text="#{dashboard.admin.courseOverview}">Course Overview</h2>
        <div class="lms-table-wrap mb-5">
            <table class="table">
                <thead>
                    <tr>
                        <th th:text="#{dashboard.admin.course.code}">Code</th>
                        <th th:text="#{dashboard.admin.course.title}">Title</th>
                        <th th:text="#{dashboard.admin.course.instructor}">Instructor</th>
                        <th th:text="#{dashboard.admin.course.created}">Created</th>
                        <th th:text="#{dashboard.admin.course.actions}">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="course : ${courses}">
                        <td>
                            <span class="lms-badge-blue" th:text="${course.code}">CS101</span>
                        </td>
                        <td th:text="${course.title}">Course Title</td>
                        <td th:text="${course.instructor != null ? course.instructor.username : 'N/A'}">Instructor</td>
                        <td th:text="${#temporals.format(course.createdAt, 'MMM dd, yyyy')}">Jan 01, 2025</td>
                        <td>
                            <a th:href="@{/courses/{id}(id=${course.id})}" class="text-decoration-none me-2">
                                <i class="bi bi-eye"></i>
                            </a>
                            <form th:action="@{/courses/{id}/delete(id=${course.id})}" method="post" class="d-inline" onsubmit="return confirm('[[#{dashboard.admin.course.deleteConfirm}]]');">
                                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                                <button type="submit" class="btn btn-link text-danger p-0 border-0">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </form>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Quick Actions Card -->
        <div class="row">
            <div class="col-md-6 mx-auto">
                <div class="lms-card" style="padding:1.25rem;">
                    <h6 class="text-uppercase text-muted mb-3" style="font-size:.75rem;letter-spacing:.04em;" th:text="#{dashboard.admin.actionsTitle}">Admin Actions</h6>
                    <div class="d-grid gap-2">
                        <a th:href="@{/courses/new}" class="btn btn-lms" th:text="#{dashboard.admin.action.createCourse}">Create Course</a>
                        <a th:href="@{/courses}" class="btn btn-lms-outline" th:text="#{dashboard.admin.action.viewCourses}">View All Courses</a>
                        <a th:href="@{/admin/users/new}" class="btn btn-lms-outline" th:text="#{dashboard.admin.action.addUser}">Add User</a>
                        <a th:href="@{/admin/users}" class="btn btn-lms-outline" th:text="#{dashboard.admin.action.manageUsers}">Manage Users</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="lms-footer">
        <div class="container text-center">
            <span th:text="#{app.footer.copy}">LMS</span>
            <span class="mx-2">&middot;</span>
            <span th:text="#{app.footer.builtWith}">Spring Boot</span>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
